{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "2025.2.4+fea52c8", "generated_at": "2025-02-06T15:50:48.406504Z", "invocation_id": "05861347-e09f-4fc6-bfe9-8a7d7a4e6655", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-06T15:50:04.623694Z", "completed_at": "2025-02-06T15:50:04.653572Z"}, {"name": "execute", "started_at": "2025-02-06T15:50:04.661608Z", "completed_at": "2025-02-06T15:50:06.326136Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.705937385559082, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "asia-southeast1", "project_id": "ny-rides-peter-415106", "job_id": "57542094-e449-49aa-a029-8f946a7a09c4", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.taxi_rides_ny.stg_greentaxi_trips", "compiled": true, "compiled_code": "\n\nwith tripdata as \n(\n  select \n    *,\n    row_number() over(partition by vendorid, lpep_pickup_datetime) as rn\n  from `ny-rides-peter-415106`.`nyc_tlc_data`.`greentaxi_trips`\n  where vendorid is not null \n)\nselect\n    -- identifiers\n    to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,\n    safe_cast(vendorid as INT64) as vendorid,\n    safe_cast(ratecodeid as INT64) as ratecodeid,\n    safe_cast(pulocationid as INT64) as pickup_locationid,\n    safe_cast(dolocationid as INT64) as dropoff_locationid,\n    \n    -- timestamps\n    cast(lpep_pickup_datetime as timestamp) as pickup_datetime,\n    cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,\n    \n    -- trip info\n    store_and_fwd_flag,\n    safe_cast(passenger_count as INT64) as passenger_count,\n    cast(trip_distance as numeric) as trip_distance,\n    safe_cast(trip_type as INT64) as trip_type,\n\n    -- payment info\n    cast(fare_amount as numeric) as fare_amount,\n    cast(extra as numeric) as extra,\n    cast(mta_tax as numeric) as mta_tax,\n    cast(tip_amount as numeric) as tip_amount,\n    cast(tolls_amount as numeric) as tolls_amount,\n    cast(ehail_fee as numeric) as ehail_fee,\n    cast(improvement_surcharge as numeric) as improvement_surcharge,\n    cast(total_amount as numeric) as total_amount,\n    coalesce(safe_cast(payment_type as INT64),0) as payment_type,\n    case cast( payment_type as integer)\n        when 1 then 'Credit card'\n        when 2 then 'Cash'\n        when 3 then 'No charge'\n        when 4 then 'Dispute'\n        when 5 then 'Unknown'\n        when 6 then 'Voided trip'\n        else 'EMPTY'\n    end as payment_type_description\nfrom tripdata\nwhere rn = 1\n\n\n-- dbt build --select <model_name> --vars '{'is_test_run': false}'\n\n\n  limit 100\n\n", "relation_name": "`ny-rides-peter-415106`.`dbt_pchettiar`.`stg_greentaxi_trips`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-06T15:50:04.634358Z", "completed_at": "2025-02-06T15:50:04.654787Z"}, {"name": "execute", "started_at": "2025-02-06T15:50:04.683293Z", "completed_at": "2025-02-06T15:50:06.351889Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.7408506870269775, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "asia-southeast1", "project_id": "ny-rides-peter-415106", "job_id": "f9a648d0-5415-4352-8504-0f2c55212d6b", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.taxi_rides_ny.stg_yellowtaxi_trips", "compiled": true, "compiled_code": "\n \nwith tripdata as \n(\n  select \n    *,\n    row_number() over(partition by vendorid, tpep_pickup_datetime) as rn\n  from `ny-rides-peter-415106`.`nyc_tlc_data`.`yellowtaxi_trips`\n  where vendorid is not null \n)\nselect\n   -- identifiers\n    to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,    \n    safe_cast(vendorid as INT64) as vendorid,\n    safe_cast(ratecodeid as INT64) as ratecodeid,\n    safe_cast(pulocationid as INT64) as pickup_locationid,\n    safe_cast(dolocationid as INT64) as dropoff_locationid,\n\n    -- timestamps\n    cast(tpep_pickup_datetime as timestamp) as pickup_datetime,\n    cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,\n    \n    -- trip info\n    store_and_fwd_flag,\n    safe_cast(passenger_count as INT64) as passenger_count,\n    cast(trip_distance as numeric) as trip_distance,\n    -- yellow cabs are always street-hail\n    1 as trip_type,\n    \n    -- payment info\n    cast(fare_amount as numeric) as fare_amount,\n    cast(extra as numeric) as extra,\n    cast(mta_tax as numeric) as mta_tax,\n    cast(tip_amount as numeric) as tip_amount,\n    cast(tolls_amount as numeric) as tolls_amount,\n    cast(0 as numeric) as ehail_fee,\n    cast(improvement_surcharge as numeric) as improvement_surcharge,\n    cast(total_amount as numeric) as total_amount,\n    coalesce(safe_cast(payment_type as INT64),0) as payment_type,\n    case cast( payment_type as integer)\n        when 1 then 'Credit card'\n        when 2 then 'Cash'\n        when 3 then 'No charge'\n        when 4 then 'Dispute'\n        when 5 then 'Unknown'\n        when 6 then 'Voided trip'\n        else 'EMPTY'\n    end as payment_type_description\nfrom tripdata\nwhere rn = 1\n\n-- dbt build --select <model.sql> --vars '{'is_test_run: false}'\n\n\n  limit 100\n\n", "relation_name": "`ny-rides-peter-415106`.`dbt_pchettiar`.`stg_yellowtaxi_trips`", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-02-06T15:50:06.352024Z", "completed_at": "2025-02-06T15:50:06.374201Z"}, {"name": "execute", "started_at": "2025-02-06T15:50:06.387475Z", "completed_at": "2025-02-06T15:50:09.400485Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 3.065211296081543, "adapter_response": {"_message": "SELECT (1.0 rows, 118.3 MiB processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 124046560, "bytes_billed": 124780544, "location": "asia-southeast1", "project_id": "ny-rides-peter-415106", "job_id": "d33ebb79-32e4-4151-99a3-930d42ef08d9", "slot_ms": 11993}, "message": null, "failures": 0, "unique_id": "test.taxi_rides_ny.not_null_stg_greentaxi_trips_tripid.4872c2d07f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect tripid\nfrom `ny-rides-peter-415106`.`dbt_pchettiar`.`stg_greentaxi_trips`\nwhere tripid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-02-06T15:50:06.337711Z", "completed_at": "2025-02-06T15:50:06.372225Z"}, {"name": "execute", "started_at": "2025-02-06T15:50:06.374724Z", "completed_at": "2025-02-06T15:50:09.580763Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 3.24686336517334, "adapter_response": {"_message": "SELECT (1.0 rows, 172.9 MiB processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 181304584, "bytes_billed": 181403648, "location": "asia-southeast1", "project_id": "ny-rides-peter-415106", "job_id": "c4123f34-1aef-4a8d-b170-1dd21cb90e6b", "slot_ms": 7961}, "message": null, "failures": 0, "unique_id": "test.taxi_rides_ny.accepted_values_stg_greentaxi_trips_payment_type__False___var_payment_type_values_.4ee7644774", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        payment_type as value_field,\n        count(*) as n_records\n\n    from `ny-rides-peter-415106`.`dbt_pchettiar`.`stg_greentaxi_trips`\n    group by payment_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    1,2,3,4,5,6\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-02-06T15:50:06.362886Z", "completed_at": "2025-02-06T15:50:06.385001Z"}, {"name": "execute", "started_at": "2025-02-06T15:50:06.388773Z", "completed_at": "2025-02-06T15:50:10.431220Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 4.094932317733765, "adapter_response": {"_message": "SELECT (1.0 rows, 118.3 MiB processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 124046560, "bytes_billed": 124780544, "location": "asia-southeast1", "project_id": "ny-rides-peter-415106", "job_id": "e7b9a55e-705c-4b0e-9ee0-96c1c9b0f411", "slot_ms": 8156}, "message": null, "failures": 0, "unique_id": "test.taxi_rides_ny.unique_stg_greentaxi_trips_tripid.c087295752", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select tripid as unique_field\n  from `ny-rides-peter-415106`.`dbt_pchettiar`.`stg_greentaxi_trips`\n  where tripid is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-02-06T15:50:06.518493Z", "completed_at": "2025-02-06T15:50:06.533835Z"}, {"name": "execute", "started_at": "2025-02-06T15:50:06.534730Z", "completed_at": "2025-02-06T15:50:12.324502Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.929528713226318, "adapter_response": {"_message": "SELECT (1.0 rows, 2.7 GiB processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 2946914080, "bytes_billed": 2947547136, "location": "asia-southeast1", "project_id": "ny-rides-peter-415106", "job_id": "fe5bf5d4-0e43-490a-bc76-3156d6de2390", "slot_ms": 104549}, "message": null, "failures": 0, "unique_id": "test.taxi_rides_ny.accepted_values_stg_yellowtaxi_trips_payment_type__False___var_payment_type_values_.c27319ca5a", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        payment_type as value_field,\n        count(*) as n_records\n\n    from `ny-rides-peter-415106`.`dbt_pchettiar`.`stg_yellowtaxi_trips`\n    group by payment_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    1,2,3,4,5,6\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-02-06T15:50:06.527760Z", "completed_at": "2025-02-06T15:50:06.534268Z"}, {"name": "execute", "started_at": "2025-02-06T15:50:06.536024Z", "completed_at": "2025-02-06T15:50:14.060055Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 7.664140462875366, "adapter_response": {"_message": "SELECT (1.0 rows, 1.8 GiB processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 1969649912, "bytes_billed": 1970274304, "location": "asia-southeast1", "project_id": "ny-rides-peter-415106", "job_id": "e240742c-b821-4dde-8842-ccd2b63c3010", "slot_ms": 83785}, "message": null, "failures": 0, "unique_id": "test.taxi_rides_ny.not_null_stg_yellowtaxi_trips_tripid.c907231499", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect tripid\nfrom `ny-rides-peter-415106`.`dbt_pchettiar`.`stg_yellowtaxi_trips`\nwhere tripid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-02-06T15:50:09.404281Z", "completed_at": "2025-02-06T15:50:09.410152Z"}, {"name": "execute", "started_at": "2025-02-06T15:50:09.410561Z", "completed_at": "2025-02-06T15:50:15.153297Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 5.750207424163818, "adapter_response": {"_message": "SELECT (1.0 rows, 1.8 GiB processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 1969649912, "bytes_billed": 1970274304, "location": "asia-southeast1", "project_id": "ny-rides-peter-415106", "job_id": "d08eaf4f-810e-4e29-a91f-527787f305a5", "slot_ms": 74980}, "message": null, "failures": 0, "unique_id": "test.taxi_rides_ny.unique_stg_yellowtaxi_trips_tripid.85fb553534", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select tripid as unique_field\n  from `ny-rides-peter-415106`.`dbt_pchettiar`.`stg_yellowtaxi_trips`\n  where tripid is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-06T15:50:04.641872Z", "completed_at": "2025-02-06T15:50:04.641876Z"}, {"name": "execute", "started_at": "2025-02-06T15:50:04.642552Z", "completed_at": "2025-02-06T15:50:17.467086Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 12.845537900924683, "adapter_response": {"_message": "INSERT 265", "code": "INSERT", "rows_affected": 265}, "message": "INSERT 265", "failures": null, "unique_id": "seed.taxi_rides_ny.taxi_zone_lookup", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-02-06T15:50:17.491878Z", "completed_at": "2025-02-06T15:50:17.518177Z"}, {"name": "execute", "started_at": "2025-02-06T15:50:17.529026Z", "completed_at": "2025-02-06T15:50:20.600430Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.1239757537841797, "adapter_response": {"_message": "SELECT (1.0 rows, 182.0 MiB processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 190839336, "bytes_billed": 190840832, "location": "asia-southeast1", "project_id": "ny-rides-peter-415106", "job_id": "80fca82d-ad1a-46dd-a84e-dbd0c04975f8", "slot_ms": 10677}, "message": null, "failures": 0, "unique_id": "test.taxi_rides_ny.relationships_stg_greentaxi_trips_pickup_locationid__locationid__ref_taxi_zone_lookup_.877c597471", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select pickup_locationid as from_field\n    from `ny-rides-peter-415106`.`dbt_pchettiar`.`stg_greentaxi_trips`\n    where pickup_locationid is not null\n),\n\nparent as (\n    select locationid as to_field\n    from `ny-rides-peter-415106`.`dbt_pchettiar`.`taxi_zone_lookup`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-02-06T15:50:17.482158Z", "completed_at": "2025-02-06T15:50:17.517576Z"}, {"name": "execute", "started_at": "2025-02-06T15:50:17.526702Z", "completed_at": "2025-02-06T15:50:20.605038Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 3.1289844512939453, "adapter_response": {"_message": "SELECT (1.0 rows, 182.0 MiB processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 190839336, "bytes_billed": 190840832, "location": "asia-southeast1", "project_id": "ny-rides-peter-415106", "job_id": "7323f342-9446-456a-b8e6-a25806b8e34a", "slot_ms": 7625}, "message": null, "failures": 0, "unique_id": "test.taxi_rides_ny.relationships_stg_greentaxi_trips_dropoff_locationid__locationid__ref_taxi_zone_lookup_.b47b903e84", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select dropoff_locationid as from_field\n    from `ny-rides-peter-415106`.`dbt_pchettiar`.`stg_greentaxi_trips`\n    where dropoff_locationid is not null\n),\n\nparent as (\n    select locationid as to_field\n    from `ny-rides-peter-415106`.`dbt_pchettiar`.`taxi_zone_lookup`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-06T15:50:17.479881Z", "completed_at": "2025-02-06T15:50:17.516981Z"}, {"name": "execute", "started_at": "2025-02-06T15:50:17.519131Z", "completed_at": "2025-02-06T15:50:21.086859Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 3.611849069595337, "adapter_response": {"_message": "CREATE TABLE (265.0 rows, 14.2 KiB processed)", "code": "CREATE TABLE", "rows_affected": 265, "bytes_processed": 14504, "bytes_billed": 10485760, "location": "asia-southeast1", "project_id": "ny-rides-peter-415106", "job_id": "1d625189-137c-4a37-82fe-352c2bb12a45", "slot_ms": 1860}, "message": "CREATE TABLE (265.0 rows, 14.2 KiB processed)", "failures": null, "unique_id": "model.taxi_rides_ny.dim_zones", "compiled": true, "compiled_code": "\n\nselect\n    locationid,\n    borough,\n    zone,\n    replace(service_zone, 'Boro', 'Green') as service_zone\nfrom `ny-rides-peter-415106`.`dbt_pchettiar`.`taxi_zone_lookup`", "relation_name": "`ny-rides-peter-415106`.`dbt_pchettiar`.`dim_zones`", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-02-06T15:50:17.497017Z", "completed_at": "2025-02-06T15:50:17.518675Z"}, {"name": "execute", "started_at": "2025-02-06T15:50:17.530403Z", "completed_at": "2025-02-06T15:50:24.332306Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 6.855537414550781, "adapter_response": {"_message": "SELECT (1.0 rows, 2.8 GiB processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 2962039896, "bytes_billed": 2962227200, "location": "asia-southeast1", "project_id": "ny-rides-peter-415106", "job_id": "8ede68d6-c774-4a8a-96ed-fff73663a2d9", "slot_ms": 96177}, "message": null, "failures": 0, "unique_id": "test.taxi_rides_ny.relationships_stg_yellowtaxi_trips_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e5b8799525", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select dropoff_locationid as from_field\n    from `ny-rides-peter-415106`.`dbt_pchettiar`.`stg_yellowtaxi_trips`\n    where dropoff_locationid is not null\n),\n\nparent as (\n    select locationid as to_field\n    from `ny-rides-peter-415106`.`dbt_pchettiar`.`taxi_zone_lookup`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-02-06T15:50:17.508680Z", "completed_at": "2025-02-06T15:50:17.528550Z"}, {"name": "execute", "started_at": "2025-02-06T15:50:17.571233Z", "completed_at": "2025-02-06T15:50:25.480374Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 8.002564191818237, "adapter_response": {"_message": "SELECT (1.0 rows, 2.8 GiB processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 2962039896, "bytes_billed": 2962227200, "location": "asia-southeast1", "project_id": "ny-rides-peter-415106", "job_id": "53bbe7fb-a91a-46de-8cbf-d2f5d6fc0f65", "slot_ms": 100111}, "message": null, "failures": 0, "unique_id": "test.taxi_rides_ny.relationships_stg_yellowtaxi_trips_pickup_locationid__locationid__ref_taxi_zone_lookup_.77b6b8cf7e", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select pickup_locationid as from_field\n    from `ny-rides-peter-415106`.`dbt_pchettiar`.`stg_yellowtaxi_trips`\n    where pickup_locationid is not null\n),\n\nparent as (\n    select locationid as to_field\n    from `ny-rides-peter-415106`.`dbt_pchettiar`.`taxi_zone_lookup`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-06T15:50:25.484611Z", "completed_at": "2025-02-06T15:50:25.487339Z"}, {"name": "execute", "started_at": "2025-02-06T15:50:25.487772Z", "completed_at": "2025-02-06T15:50:43.679417Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 18.19597554206848, "adapter_response": {"_message": "CREATE TABLE (192.0 rows, 16.1 GiB processed)", "code": "CREATE TABLE", "rows_affected": 192, "bytes_processed": 17308802932, "bytes_billed": 17308844032, "location": "asia-southeast1", "project_id": "ny-rides-peter-415106", "job_id": "6bf6615b-51bc-4d5d-89da-97c5293af37a", "slot_ms": 286783}, "message": "CREATE TABLE (192.0 rows, 16.1 GiB processed)", "failures": null, "unique_id": "model.taxi_rides_ny.fact_trips", "compiled": true, "compiled_code": "\n\nwith green_tripdata as (\n    select *, \n        'Green' as service_type\n    from `ny-rides-peter-415106`.`dbt_pchettiar`.`stg_greentaxi_trips`\n), \nyellow_tripdata as (\n    select *, \n        'Yellow' as service_type\n    from `ny-rides-peter-415106`.`dbt_pchettiar`.`stg_yellowtaxi_trips`\n), \ntrips_unioned as (\n    select * from green_tripdata\n    union all \n    select * from yellow_tripdata\n), \ndim_zones as (\n    select * from `ny-rides-peter-415106`.`dbt_pchettiar`.`dim_zones`\n    where borough != 'Unknown'\n)\n\nselect trips_unioned.tripid, \n    trips_unioned.vendorid, \n    trips_unioned.service_type,\n    trips_unioned.ratecodeid, \n    trips_unioned.pickup_locationid, \n    pickup_zone.borough as pickup_borough, \n    pickup_zone.zone as pickup_zone, \n    trips_unioned.dropoff_locationid,\n    dropoff_zone.borough as dropoff_borough, \n    dropoff_zone.zone as dropoff_zone,  \n    trips_unioned.pickup_datetime, \n    trips_unioned.dropoff_datetime, \n    trips_unioned.store_and_fwd_flag, \n    trips_unioned.passenger_count, \n    trips_unioned.trip_distance, \n    trips_unioned.trip_type, \n    trips_unioned.fare_amount, \n    trips_unioned.extra, \n    trips_unioned.mta_tax, \n    trips_unioned.tip_amount, \n    trips_unioned.tolls_amount, \n    trips_unioned.ehail_fee, \n    trips_unioned.improvement_surcharge, \n    trips_unioned.total_amount, \n    trips_unioned.payment_type, \n    trips_unioned.payment_type_description\nfrom trips_unioned\ninner join dim_zones as pickup_zone\non trips_unioned.pickup_locationid = pickup_zone.locationid\ninner join dim_zones as dropoff_zone\non trips_unioned.dropoff_locationid = dropoff_zone.locationid", "relation_name": "`ny-rides-peter-415106`.`dbt_pchettiar`.`fact_trips`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-06T15:50:43.684399Z", "completed_at": "2025-02-06T15:50:43.687366Z"}, {"name": "execute", "started_at": "2025-02-06T15:50:43.687777Z", "completed_at": "2025-02-06T15:50:46.818763Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 3.1356544494628906, "adapter_response": {"_message": "CREATE TABLE (93.0 rows, 39.7 KiB processed)", "code": "CREATE TABLE", "rows_affected": 93, "bytes_processed": 40636, "bytes_billed": 10485760, "location": "asia-southeast1", "project_id": "ny-rides-peter-415106", "job_id": "94b5a466-b425-476d-ae25-abcedcdf3cda", "slot_ms": 1467}, "message": "CREATE TABLE (93.0 rows, 39.7 KiB processed)", "failures": null, "unique_id": "model.taxi_rides_ny.dm_monthly_zone_revenue", "compiled": true, "compiled_code": "\n\nwith fact_trips as (\n    select\n        *\n    from `ny-rides-peter-415106`.`dbt_pchettiar`.`fact_trips`\n)\n\nselect\n    -- Revenue grouping\n    pickup_zone as revenue_zone,\n    timestamp_trunc(\n        cast(pickup_datetime as timestamp),\n        month\n    ) as revenue_month,\n\n    service_type,\n\n    -- Revenue calculation\n    sum(fare_amount) as revenue_monthly_fare,\n    sum(extra) as revenue_monthly_extra,\n    sum(mta_tax) as revenue_monthly_mta_tax,\n    sum(tip_amount) as revenue_monthly_tip_amount,\n    sum(tolls_amount) as revenue_monthly_tolls_amount,\n    sum(ehail_fee) as revenue_monthly_ehail_fee,\n    sum(improvement_surcharge) as revenue_monthly_improvement_surcharge,\n    sum(total_amount) as revenue_monthly_total_amount,\n\n    -- Additional calculations\n    count(tripid) as total_monthly_trips,\n    avg(passenger_count) as avg_monthly_passenger_count,\n    avg(trip_distance) as avg_monthly_trip_distance\n\n    from fact_trips\n    group by 1,2,3", "relation_name": "`ny-rides-peter-415106`.`dbt_pchettiar`.`dm_monthly_zone_revenue`", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-02-06T15:50:46.823855Z", "completed_at": "2025-02-06T15:50:46.831380Z"}, {"name": "execute", "started_at": "2025-02-06T15:50:46.831794Z", "completed_at": "2025-02-06T15:50:48.362059Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.5396363735198975, "adapter_response": {"_message": "SELECT (1.0 rows, 1.5 KiB processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 1488, "bytes_billed": 10485760, "location": "asia-southeast1", "project_id": "ny-rides-peter-415106", "job_id": "d867aa59-eb7b-41d2-a407-fb312947998d", "slot_ms": 32}, "message": null, "failures": 0, "unique_id": "test.taxi_rides_ny.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect revenue_monthly_total_amount\nfrom `ny-rides-peter-415106`.`dbt_pchettiar`.`dm_monthly_zone_revenue`\nwhere revenue_monthly_total_amount is null\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 44.738744497299194, "args": {"populate_cache": true, "require_yaml_configuration_for_mf_time_spines": false, "exclude": [], "quiet": false, "skip_nodes_if_on_run_start_fails": false, "printer_width": 80, "state_modified_compare_vars": false, "require_explicit_package_overrides_for_builtin_materializations": true, "write_json": true, "send_anonymous_usage_stats": true, "print": true, "skip_write_msgpack_if_exist": false, "empty": false, "export_saved_queries": false, "macro_debugging": false, "partial_parse": true, "indirect_selection": "eager", "log_path": "/usr/src/dbt-server-shared/working_dir/6f59c4cb-d31a-4e6a-9ccc-083b626f0447", "log_format_file": "json", "strict_mode": false, "use_fast_test_edges": false, "source_freshness_run_project_hooks": false, "defer": false, "log_level": "info", "partial_parse_file_diff": true, "favor_state": false, "profile": "user", "project_dir": "/usr/src/develop/user-70471823412632/environment-70471823413086/repository-70471823404640/Module-4-analytics-engineering/taxi_rides_ny", "show": false, "version_check": true, "cache_selected_only": false, "introspect": true, "resource_types": [], "show_resource_report": false, "require_batched_execution_for_custom_microbatch_strategy": false, "require_resource_names_without_spaces": false, "include_saved_query": false, "require_nested_cumulative_type_params": false, "which": "build", "exclude_resource_types": [], "profiles_dir": "/usr/src/dbt-server-shared/.dbt", "state_modified_compare_more_unrendered_values": false, "log_file_max_bytes": 0, "log_format": "json", "log_level_file": "debug", "warn_error_options": {"include": [], "exclude": []}, "select": [], "use_colors": true, "invocation_command": "dbt -A dbt_worker.app worker --loglevel=DEBUG --concurrency=2 --max-memory-per-child=500000", "use_colors_file": true, "vars": {}, "static_parser": true}}