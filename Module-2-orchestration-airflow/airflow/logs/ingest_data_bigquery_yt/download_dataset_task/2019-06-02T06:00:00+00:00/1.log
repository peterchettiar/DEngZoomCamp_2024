[2024-05-02 03:33:56,275] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: ingest_data_bigquery_yt.download_dataset_task scheduled__2019-06-02T06:00:00+00:00 [queued]>
[2024-05-02 03:33:56,379] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: ingest_data_bigquery_yt.download_dataset_task scheduled__2019-06-02T06:00:00+00:00 [queued]>
[2024-05-02 03:33:56,386] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2024-05-02 03:33:56,390] {taskinstance.py:1239} INFO - Starting attempt 1 of 2
[2024-05-02 03:33:56,394] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2024-05-02 03:33:56,477] {taskinstance.py:1259} INFO - Executing <Task(BashOperator): download_dataset_task> on 2019-06-02 06:00:00+00:00
[2024-05-02 03:33:56,516] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'ingest_data_bigquery_yt', 'download_dataset_task', 'scheduled__2019-06-02T06:00:00+00:00', '--job-id', '3659', '--raw', '--subdir', 'DAGS_FOLDER/data_ingestion_gcs_yt_dag.py', '--cfg-path', '/tmp/tmp3eqc4htw', '--error-file', '/tmp/tmpgdna7mn9']
[2024-05-02 03:33:56,526] {standard_task_runner.py:77} INFO - Job 3659: Subtask download_dataset_task
[2024-05-02 03:33:56,504] {standard_task_runner.py:52} INFO - Started process 3319 to run task
[2024-05-02 03:33:56,834] {logging_mixin.py:109} INFO - Running <TaskInstance: ingest_data_bigquery_yt.download_dataset_task scheduled__2019-06-02T06:00:00+00:00 [running]> on host bef445d594dc
[2024-05-02 03:33:57,104] {warnings.py:99} WARNING - /home/***/.local/lib/python3.6/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2024-05-02 03:33:57,290] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=ingest_data_bigquery_yt
AIRFLOW_CTX_TASK_ID=download_dataset_task
AIRFLOW_CTX_EXECUTION_DATE=2019-06-02T06:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2019-06-02T06:00:00+00:00
[2024-05-02 03:33:57,292] {subprocess.py:62} INFO - Tmp dir root location: 
 /tmp
[2024-05-02 03:33:57,293] {subprocess.py:74} INFO - Running command: ['bash', '-c', 'curl -sSL https://github.com/DataTalksClub/nyc-tlc-data/releases/download/yellow/yellow_tripdata_2019-06.csv.gz > /opt/***/raw_data/yellowtaxi_tripdata_2019-06.csv.gz | gzip -d > /opt/***/raw_data/yellowtaxi_tripdata_2019-06.csv | rm /opt/***/raw_data/yellowtaxi_tripdata_2019-06.csv.gz']
[2024-05-02 03:33:57,408] {subprocess.py:85} INFO - Output:
[2024-05-02 03:33:57,563] {subprocess.py:89} INFO - 
[2024-05-02 03:33:57,563] {subprocess.py:89} INFO - gzip: stdin: unexpected end of file
[2024-05-02 03:34:01,580] {subprocess.py:93} INFO - Command exited with return code 0
[2024-05-02 03:34:01,709] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=ingest_data_bigquery_yt, task_id=download_dataset_task, execution_date=20190602T060000, start_date=20240502T033356, end_date=20240502T033401
[2024-05-02 03:34:01,839] {local_task_job.py:154} INFO - Task exited with return code 0
[2024-05-02 03:34:02,062] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2024-05-02 03:39:49,176] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: ingest_data_bigquery_yt.download_dataset_task scheduled__2019-06-02T06:00:00+00:00 [queued]>
[2024-05-02 03:39:49,227] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: ingest_data_bigquery_yt.download_dataset_task scheduled__2019-06-02T06:00:00+00:00 [queued]>
[2024-05-02 03:39:49,228] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2024-05-02 03:39:49,229] {taskinstance.py:1239} INFO - Starting attempt 1 of 2
[2024-05-02 03:39:49,229] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2024-05-02 03:39:49,256] {taskinstance.py:1259} INFO - Executing <Task(BashOperator): download_dataset_task> on 2019-06-02 06:00:00+00:00
[2024-05-02 03:39:49,266] {standard_task_runner.py:52} INFO - Started process 3824 to run task
[2024-05-02 03:39:49,301] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'ingest_data_bigquery_yt', 'download_dataset_task', 'scheduled__2019-06-02T06:00:00+00:00', '--job-id', '3700', '--raw', '--subdir', 'DAGS_FOLDER/data_ingestion_gcs_yt_dag.py', '--cfg-path', '/tmp/tmp1qlhbiwm', '--error-file', '/tmp/tmpj46u6hly']
[2024-05-02 03:39:49,327] {standard_task_runner.py:77} INFO - Job 3700: Subtask download_dataset_task
[2024-05-02 03:39:49,478] {logging_mixin.py:109} INFO - Running <TaskInstance: ingest_data_bigquery_yt.download_dataset_task scheduled__2019-06-02T06:00:00+00:00 [running]> on host bef445d594dc
[2024-05-02 03:39:49,552] {warnings.py:99} WARNING - /home/***/.local/lib/python3.6/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2024-05-02 03:39:49,616] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=ingest_data_bigquery_yt
AIRFLOW_CTX_TASK_ID=download_dataset_task
AIRFLOW_CTX_EXECUTION_DATE=2019-06-02T06:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2019-06-02T06:00:00+00:00
[2024-05-02 03:39:49,617] {subprocess.py:62} INFO - Tmp dir root location: 
 /tmp
[2024-05-02 03:39:49,618] {subprocess.py:74} INFO - Running command: ['bash', '-c', 'curl -sSL https://github.com/DataTalksClub/nyc-tlc-data/releases/download/yellow/yellow_tripdata_2019-06.csv.gz > /opt/***/raw_data/yellowtaxi_tripdata_2019-06.csv.gz | gzip -d > /opt/***/raw_data/yellowtaxi_tripdata_2019-06.csv && rm /opt/***/raw_data/yellowtaxi_tripdata_2019-06.csv.gz']
[2024-05-02 03:39:49,660] {subprocess.py:85} INFO - Output:
[2024-05-02 03:39:49,683] {subprocess.py:89} INFO - 
[2024-05-02 03:39:49,686] {subprocess.py:89} INFO - gzip: stdin: unexpected end of file
[2024-05-02 03:39:51,800] {subprocess.py:93} INFO - Command exited with return code 1
[2024-05-02 03:39:51,824] {taskinstance.py:1700} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/operators/bash.py", line 188, in execute
    f'Bash command failed. The command returned a non-zero exit code {result.exit_code}.'
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2024-05-02 03:39:51,889] {taskinstance.py:1277} INFO - Marking task as UP_FOR_RETRY. dag_id=ingest_data_bigquery_yt, task_id=download_dataset_task, execution_date=20190602T060000, start_date=20240502T033949, end_date=20240502T033951
[2024-05-02 03:39:52,352] {standard_task_runner.py:92} ERROR - Failed to execute job 3700 for task download_dataset_task
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/cli/commands/task_command.py", line 298, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/cli/commands/task_command.py", line 184, in _run_raw_task
    error_file=args.error_file,
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/operators/bash.py", line 188, in execute
    f'Bash command failed. The command returned a non-zero exit code {result.exit_code}.'
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2024-05-02 03:39:52,387] {local_task_job.py:154} INFO - Task exited with return code 1
[2024-05-02 03:39:52,774] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-05-02 03:57:56,443] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: ingest_data_bigquery_yt.download_dataset_task scheduled__2019-06-02T06:00:00+00:00 [queued]>
[2024-05-02 03:57:56,480] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: ingest_data_bigquery_yt.download_dataset_task scheduled__2019-06-02T06:00:00+00:00 [queued]>
[2024-05-02 03:57:56,481] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2024-05-02 03:57:56,481] {taskinstance.py:1239} INFO - Starting attempt 1 of 2
[2024-05-02 03:57:56,481] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2024-05-02 03:57:56,611] {taskinstance.py:1259} INFO - Executing <Task(BashOperator): download_dataset_task> on 2019-06-02 06:00:00+00:00
[2024-05-02 03:57:56,669] {standard_task_runner.py:52} INFO - Started process 4727 to run task
[2024-05-02 03:57:56,717] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'ingest_data_bigquery_yt', 'download_dataset_task', 'scheduled__2019-06-02T06:00:00+00:00', '--job-id', '3709', '--raw', '--subdir', 'DAGS_FOLDER/data_ingestion_gcs_yt_dag.py', '--cfg-path', '/tmp/tmpqbn3eij6', '--error-file', '/tmp/tmpklteb1s4']
[2024-05-02 03:57:56,760] {standard_task_runner.py:77} INFO - Job 3709: Subtask download_dataset_task
[2024-05-02 03:57:57,097] {logging_mixin.py:109} INFO - Running <TaskInstance: ingest_data_bigquery_yt.download_dataset_task scheduled__2019-06-02T06:00:00+00:00 [running]> on host bef445d594dc
[2024-05-02 03:57:57,299] {warnings.py:99} WARNING - /home/***/.local/lib/python3.6/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2024-05-02 03:57:57,411] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=ingest_data_bigquery_yt
AIRFLOW_CTX_TASK_ID=download_dataset_task
AIRFLOW_CTX_EXECUTION_DATE=2019-06-02T06:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2019-06-02T06:00:00+00:00
[2024-05-02 03:57:57,416] {subprocess.py:62} INFO - Tmp dir root location: 
 /tmp
[2024-05-02 03:57:57,417] {subprocess.py:74} INFO - Running command: ['bash', '-c', 'curl -sSL https://github.com/DataTalksClub/nyc-tlc-data/releases/download/yellow/yellow_tripdata_2019-06.csv.gz > /opt/***/raw_data/yellowtaxi_tripdata_2019-06.csv.gz | gzip -d > /opt/***/raw_data/yellowtaxi_tripdata_2019-06.csv && rm /opt/***/raw_data/yellowtaxi_tripdata_2019-06.csv.gz']
[2024-05-02 03:57:57,571] {subprocess.py:85} INFO - Output:
[2024-05-02 03:57:57,806] {subprocess.py:89} INFO - 
[2024-05-02 03:57:57,807] {subprocess.py:89} INFO - gzip: stdin: unexpected end of file
[2024-05-02 03:58:01,978] {subprocess.py:93} INFO - Command exited with return code 1
[2024-05-02 03:58:02,041] {taskinstance.py:1700} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/operators/bash.py", line 188, in execute
    f'Bash command failed. The command returned a non-zero exit code {result.exit_code}.'
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2024-05-02 03:58:02,056] {taskinstance.py:1277} INFO - Marking task as UP_FOR_RETRY. dag_id=ingest_data_bigquery_yt, task_id=download_dataset_task, execution_date=20190602T060000, start_date=20240502T035756, end_date=20240502T035802
[2024-05-02 03:58:02,536] {standard_task_runner.py:92} ERROR - Failed to execute job 3709 for task download_dataset_task
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/cli/commands/task_command.py", line 298, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/cli/commands/task_command.py", line 184, in _run_raw_task
    error_file=args.error_file,
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/operators/bash.py", line 188, in execute
    f'Bash command failed. The command returned a non-zero exit code {result.exit_code}.'
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2024-05-02 03:58:02,581] {local_task_job.py:154} INFO - Task exited with return code 1
[2024-05-02 03:58:02,781] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-05-02 17:52:40,952] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: ingest_data_bigquery_yt.download_dataset_task scheduled__2019-06-02T06:00:00+00:00 [queued]>
[2024-05-02 17:52:41,012] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: ingest_data_bigquery_yt.download_dataset_task scheduled__2019-06-02T06:00:00+00:00 [queued]>
[2024-05-02 17:52:41,012] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2024-05-02 17:52:41,012] {taskinstance.py:1239} INFO - Starting attempt 1 of 2
[2024-05-02 17:52:41,013] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2024-05-02 17:52:41,209] {taskinstance.py:1259} INFO - Executing <Task(BashOperator): download_dataset_task> on 2019-06-02 06:00:00+00:00
[2024-05-02 17:52:41,255] {standard_task_runner.py:52} INFO - Started process 4142 to run task
[2024-05-02 17:52:41,283] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'ingest_data_bigquery_yt', 'download_dataset_task', 'scheduled__2019-06-02T06:00:00+00:00', '--job-id', '3809', '--raw', '--subdir', 'DAGS_FOLDER/data_ingestion_gcs_yt_dag.py', '--cfg-path', '/tmp/tmp67p6q6wn', '--error-file', '/tmp/tmpdcu9xha3']
[2024-05-02 17:52:41,335] {standard_task_runner.py:77} INFO - Job 3809: Subtask download_dataset_task
[2024-05-02 17:52:41,642] {logging_mixin.py:109} INFO - Running <TaskInstance: ingest_data_bigquery_yt.download_dataset_task scheduled__2019-06-02T06:00:00+00:00 [running]> on host 1ed1a38cd1e3
[2024-05-02 17:52:41,805] {warnings.py:99} WARNING - /home/***/.local/lib/python3.6/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2024-05-02 17:52:41,901] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=ingest_data_bigquery_yt
AIRFLOW_CTX_TASK_ID=download_dataset_task
AIRFLOW_CTX_EXECUTION_DATE=2019-06-02T06:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2019-06-02T06:00:00+00:00
[2024-05-02 17:52:41,903] {subprocess.py:62} INFO - Tmp dir root location: 
 /tmp
[2024-05-02 17:52:41,904] {subprocess.py:74} INFO - Running command: ['bash', '-c', 'curl -sSL https://github.com/DataTalksClub/nyc-tlc-data/releases/download/yellow/yellow_tripdata_2019-06.csv.gz > /opt/***/raw_data/yellowtaxi_tripdata_2019-06.csv.gz && gunzip /opt/***/raw_data/yellowtaxi_tripdata_2019-06.csv.gz']
[2024-05-02 17:52:41,986] {subprocess.py:85} INFO - Output:
[2024-05-02 17:53:04,229] {subprocess.py:89} INFO - 
[2024-05-02 17:53:04,229] {subprocess.py:89} INFO - gzip: /opt/***/raw_data/yellowtaxi_tripdata_2019-06.csv: No space left on device
[2024-05-02 17:53:04,360] {subprocess.py:93} INFO - Command exited with return code 1
[2024-05-02 17:53:04,413] {taskinstance.py:1700} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/operators/bash.py", line 188, in execute
    f'Bash command failed. The command returned a non-zero exit code {result.exit_code}.'
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2024-05-0[2024-05-03 08:54:23,894] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: ingest_data_bigquery_yt.download_dataset_task scheduled__2019-06-02T06:00:00+00:00 [queued]>
[2024-05-03 08:54:24,041] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: ingest_data_bigquery_yt.download_dataset_task scheduled__2019-06-02T06:00:00+00:00 [queued]>
[2024-05-03 08:54:24,041] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2024-05-03 08:54:24,041] {taskinstance.py:1239} INFO - Starting attempt 1 of 2
[2024-05-03 08:54:24,041] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2024-05-03 08:54:24,231] {taskinstance.py:1259} INFO - Executing <Task(BashOperator): download_dataset_task> on 2019-06-02 06:00:00+00:00
[2024-05-03 08:54:24,299] {standard_task_runner.py:52} INFO - Started process 1432 to run task
[2024-05-03 08:54:24,356] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'ingest_data_bigquery_yt', 'download_dataset_task', 'scheduled__2019-06-02T06:00:00+00:00', '--job-id', '3930', '--raw', '--subdir', 'DAGS_FOLDER/data_ingestion_gcs_yt_dag.py', '--cfg-path', '/tmp/tmpnuykm2jn', '--error-file', '/tmp/tmpfo2c22t1']
[2024-05-03 08:54:24,442] {standard_task_runner.py:77} INFO - Job 3930: Subtask download_dataset_task
[2024-05-03 08:54:25,065] {logging_mixin.py:109} INFO - Running <TaskInstance: ingest_data_bigquery_yt.download_dataset_task scheduled__2019-06-02T06:00:00+00:00 [running]> on host 5bfe1025092b
[2024-05-03 08:54:25,325] {warnings.py:99} WARNING - /home/***/.local/lib/python3.6/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2024-05-03 08:54:25,504] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=ingest_data_bigquery_yt
AIRFLOW_CTX_TASK_ID=download_dataset_task
AIRFLOW_CTX_EXECUTION_DATE=2019-06-02T06:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2019-06-02T06:00:00+00:00
[2024-05-03 08:54:25,506] {subprocess.py:62} INFO - Tmp dir root location: 
 /tmp
[2024-05-03 08:54:25,506] {subprocess.py:74} INFO - Running command: ['bash', '-c', 'curl -sSL https://github.com/DataTalksClub/nyc-tlc-data/releases/download/yellow/yellow_tripdata_2019-06.csv.gz > /opt/***/raw_data/yellowtaxi_tripdata_2019-06.csv.gz && gunzip /opt/***/raw_data/yellowtaxi_tripdata_2019-06.csv.gz']
[2024-05-03 08:54:25,620] {subprocess.py:85} INFO - Output:
[2024-05-03 08:54:39,867] {base_job.py:230} ERROR - LocalTaskJob heartbeat got an exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.6/site-packages/sqlalchemy/engine/base.py", line 1277, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.6/site-packages/sqlalchemy/engine/default.py", line 608, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.DiskFull: could not extend file "base/16384/16589": No space left on device
HINT:  Check free disk space.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/jobs/base_job.py", line 203, in heartbeat
    previous_heartbeat = self.latest_heartbeat
  File "/usr/local/lib/python3.6/contextlib.py", line 88, in __exit__
    next(self.gen)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/utils/session.py", line 32, in create_session
    session.commit()
  File "/home/airflow/.local/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 1046, in commit
    self.transaction.commit()
  File "/home/airflow/.local/lib/python3.6/site-packages/sqlalchemy/orm/session.py", line 504, in commit
    self._prepare_impl()
 [2024-05-03 09:50:40,066] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: ingest_data_bigquery_yt.download_dataset_task scheduled__2019-06-02T06:00:00+00:00 [queued]>
[2024-05-03 09:50:40,102] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: ingest_data_bigquery_yt.download_dataset_task scheduled__2019-06-02T06:00:00+00:00 [queued]>
[2024-05-03 09:50:40,102] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2024-05-03 09:50:40,103] {taskinstance.py:1239} INFO - Starting attempt 1 of 3
[2024-05-03 09:50:40,103] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2024-05-03 09:50:40,146] {taskinstance.py:1259} INFO - Executing <Task(BashOperator): download_dataset_task> on 2019-06-02 06:00:00+00:00
[2024-05-03 09:50:40,165] {standard_task_runner.py:52} INFO - Started process 642 to run task
[2024-05-03 09:50:40,189] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'ingest_data_bigquery_yt', 'download_dataset_task', 'scheduled__2019-06-02T06:00:00+00:00', '--job-id', '3998', '--raw', '--subdir', 'DAGS_FOLDER/data_ingstion_gcs_yt_dag.py', '--cfg-path', '/tmp/tmpzespxez_', '--error-file', '/tmp/tmpu8r9b1r2']
[2024-05-03 09:50:40,212] {standard_task_runner.py:77} INFO - Job 3998: Subtask download_dataset_task
[2024-05-03 09:50:40,416] {logging_mixin.py:109} INFO - Running <TaskInstance: ingest_data_bigquery_yt.download_dataset_task scheduled__2019-06-02T06:00:00+00:00 [running]> on host b81c18b6cf72
[2024-05-03 09:50:40,546] {warnings.py:99} WARNING - /home/***/.local/lib/python3.6/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2024-05-03 09:50:40,623] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=ingest_data_bigquery_yt
AIRFLOW_CTX_TASK_ID=download_dataset_task
AIRFLOW_CTX_EXECUTION_DATE=2019-06-02T06:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2019-06-02T06:00:00+00:00
[2024-05-03 09:50:40,625] {subprocess.py:62} INFO - Tmp dir root location: 
 /tmp
[2024-05-03 09:50:40,626] {subprocess.py:74} INFO - Running command: ['bash', '-c', 'curl -sSL https://github.com/DataTalksClub/nyc-tlc-data/releases/download/yellow/yellow_tripdata_2019-06.csv.gz > /opt/***/raw_data/yellowtaxi_tripdata_2019-06.csv.gz && gunzip /opt/***/raw_data/yellowtaxi_tripdata_2019-06.csv.gz']
[2024-05-03 09:50:40,675] {subprocess.py:85} INFO - Output:
[2024-05-03 09:51:01,812] {subprocess.py:89} INFO - 
[2024-05-03 09:51:01,813] {subprocess.py:89} INFO - gzip: /opt/***/raw_data/yellowtaxi_tripdata_2019-06.csv: No space left on device
[2024-05-03 09:51:02,105] {subprocess.py:93} INFO - Command exited with return code 1
[2024-05-03 09:51:02,170] {taskinstance.py:1700} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/operators/bash.py", line 188, in execute
    f'Bash command failed. The command returned a non-zero exit code {result.exit_code}.'
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2024-05-03 09:51:02,287] {taskinstance.py:1277} INFO - Marking task as UP_FOR_RETRY. dag_id=ingest_data_bigquery_yt, task_id=download_dataset_task, execution_date=20190602T060000, start_date=20240503T095040, end_date=20240503T095102
[2024-05-03 09:51:02,733] {standard_task_runner.py:92} ERROR - Failed to execute job 3998 for task download_dataset_task
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/cli/commands/task_command.py", line 298, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/cli/commands/task_command.py", line 184, in _run_raw_task
    error_file=args.error_file,
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1329, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1455, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1511, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.6/site-packages/airflow/operators/bash.py", line 188, in execute
    f'Bash command failed. The command returned a non-zero exit code {result.exit_code}.'
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2024-05-03 09:51:02,846] {local_task_job.py:154} INFO - Task exited with return code 1
[2024-05-03 09:51:03,264] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-05-03 16:39:51,853] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: ingest_data_bigquery_yt.download_dataset_task scheduled__2019-06-02T06:00:00+00:00 [queued]>
[2024-05-03 16:39:51,992] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: ingest_data_bigquery_yt.download_dataset_task scheduled__2019-06-02T06:00:00+00:00 [queued]>
[2024-05-03 16:39:51,993] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2024-05-03 16:39:51,995] {taskinstance.py:1239} INFO - Starting attempt 1 of 3
[2024-05-03 16:39:51,999] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2024-05-03 16:39:52,106] {taskinstance.py:1259} INFO - Executing <Task(BashOperator): download_dataset_task> on 2019-06-02 06:00:00+00:00
[2024-05-03 16:39:52,177] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'ingest_data_bigquery_yt', 'download_dataset_task', 'scheduled__2019-06-02T06:00:00+00:00', '--job-id', '4218', '--raw', '--subdir', 'DAGS_FOLDER/data_ingstion_gcs_yt_dag.py', '--cfg-path', '/tmp/tmp3vb6inn5', '--error-file', '/tmp/tmpxlngzvfe']
[2024-05-03 16:39:52,200] {standard_task_runner.py:77} INFO - Job 4218: Subtask download_dataset_task
[2024-05-03 16:39:52,161] {standard_task_runner.py:52} INFO - Started process 305 to run task
[2024-05-03 16:39:52,372] {logging_mixin.py:109} INFO - Running <TaskInstance: ingest_data_bigquery_yt.download_dataset_task scheduled__2019-06-02T06:00:00+00:00 [running]> on host f0ab9bf9b587
[2024-05-03 16:39:52,499] {warnings.py:99} WARNING - /home/***/.local/lib/python3.6/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2024-05-03 16:39:52,540] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=ingest_data_bigquery_yt
AIRFLOW_CTX_TASK_ID=download_dataset_task
AIRFLOW_CTX_EXECUTION_DATE=2019-06-02T06:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2019-06-02T06:00:00+00:00
[2024-05-03 16:39:52,542] {subprocess.py:62} INFO - Tmp dir root location: 
 /tmp
[2024-05-03 16:39:52,543] {subprocess.py:74} INFO - Running command: ['bash', '-c', 'curl -sSL https://github.com/DataTalksClub/nyc-tlc-data/releases/download/yellow/yellow_tripdata_2019-06.csv.gz > /opt/***/raw_data/yellowtaxi_tripdata_2019-06.csv.gz && gunzip /opt/***/raw_data/yellowtaxi_tripdata_2019-06.csv.gz']
[2024-05-03 16:39:52,566] {subprocess.py:85} INFO - Output:
[2024-05-03 16:40:37,127] {subprocess.py:93} INFO - Command exited with return code 0
[2024-05-03 16:40:37,616] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=ingest_data_bigquery_yt, task_id=download_dataset_task, execution_date=20190602T060000, start_date=20240503T163951, end_date=20240503T164037
[2024-05-03 16:40:38,054] {local_task_job.py:154} INFO - Task exited with return code 0
[2024-05-03 16:40:38,655] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2024-05-05 12:01:19,961] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: ingest_data_bigquery_yt.download_dataset_task scheduled__2019-06-02T06:00:00+00:00 [queued]>
[2024-05-05 12:01:20,029] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: ingest_data_bigquery_yt.download_dataset_task scheduled__2019-06-02T06:00:00+00:00 [queued]>
[2024-05-05 12:01:20,029] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2024-05-05 12:01:20,029] {taskinstance.py:1239} INFO - Starting attempt 1 of 3
[2024-05-05 12:01:20,030] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2024-05-05 12:01:20,077] {taskinstance.py:1259} INFO - Executing <Task(BashOperator): download_dataset_task> on 2019-06-02 06:00:00+00:00
[2024-05-05 12:01:20,105] {standard_task_runner.py:52} INFO - Started process 999 to run task
[2024-05-05 12:01:20,136] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'ingest_data_bigquery_yt', 'download_dataset_task', 'scheduled__2019-06-02T06:00:00+00:00', '--job-id', '4342', '--raw', '--subdir', 'DAGS_FOLDER/data_ingstion_gcs_yt_dag.py', '--cfg-path', '/tmp/tmpse76w_so', '--error-file', '/tmp/tmphouv4nmy']
[2024-05-05 12:01:20,156] {standard_task_runner.py:77} INFO - Job 4342: Subtask download_dataset_task
[2024-05-05 12:01:20,341] {logging_mixin.py:109} INFO - Running <TaskInstance: ingest_data_bigquery_yt.download_dataset_task scheduled__2019-06-02T06:00:00+00:00 [running]> on host 19865117eb6d
[2024-05-05 12:01:20,407] {warnings.py:99} WARNING - /home/***/.local/lib/python3.6/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2024-05-05 12:01:20,468] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=ingest_data_bigquery_yt
AIRFLOW_CTX_TASK_ID=download_dataset_task
AIRFLOW_CTX_EXECUTION_DATE=2019-06-02T06:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2019-06-02T06:00:00+00:00
[2024-05-05 12:01:20,469] {subprocess.py:62} INFO - Tmp dir root location: 
 /tmp
[2024-05-05 12:01:20,470] {subprocess.py:74} INFO - Running command: ['bash', '-c', 'curl -sSL https://github.com/DataTalksClub/nyc-tlc-data/releases/download/yellow/yellow_tripdata_2019-06.csv.gz > /opt/***/raw_data/yellowtaxi_tripdata_2019-06.csv.gz && gunzip /opt/***/raw_data/yellowtaxi_tripdata_2019-06.csv.gz']
[2024-05-05 12:01:20,555] {subprocess.py:85} INFO - Output:
[2024-05-05 12:02:11,370] {subprocess.py:93} INFO - Command exited with return code 0
[2024-05-05 12:02:12,016] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=ingest_data_bigquery_yt, task_id=download_dataset_task, execution_date=20190602T060000, start_date=20240505T120119, end_date=20240505T120212
[2024-05-05 12:02:12,088] {local_task_job.py:154} INFO - Task exited with return code 0
[2024-05-05 12:02:12,545] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2024-05-06 07:39:56,195] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: ingest_data_bigquery_yt.download_dataset_task scheduled__2019-06-02T06:00:00+00:00 [queued]>
[2024-05-06 07:39:56,246] {taskinstance.py:1032} INFO - Dependencies all met for <TaskInstance: ingest_data_bigquery_yt.download_dataset_task scheduled__2019-06-02T06:00:00+00:00 [queued]>
[2024-05-06 07:39:56,248] {taskinstance.py:1238} INFO - 
--------------------------------------------------------------------------------
[2024-05-06 07:39:56,250] {taskinstance.py:1239} INFO - Starting attempt 1 of 3
[2024-05-06 07:39:56,251] {taskinstance.py:1240} INFO - 
--------------------------------------------------------------------------------
[2024-05-06 07:39:56,310] {taskinstance.py:1259} INFO - Executing <Task(BashOperator): download_dataset_task> on 2019-06-02 06:00:00+00:00
[2024-05-06 07:39:56,332] {standard_task_runner.py:52} INFO - Started process 3251 to run task
[2024-05-06 07:39:56,402] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'ingest_data_bigquery_yt', 'download_dataset_task', 'scheduled__2019-06-02T06:00:00+00:00', '--job-id', '4496', '--raw', '--subdir', 'DAGS_FOLDER/data_ingstion_gcs_yt_dag.py', '--cfg-path', '/tmp/tmp6k5dserm', '--error-file', '/tmp/tmpjtks85ze']
[2024-05-06 07:39:56,432] {standard_task_runner.py:77} INFO - Job 4496: Subtask download_dataset_task
[2024-05-06 07:39:56,860] {logging_mixin.py:109} INFO - Running <TaskInstance: ingest_data_bigquery_yt.download_dataset_task scheduled__2019-06-02T06:00:00+00:00 [running]> on host 1aa5194a14e3
[2024-05-06 07:39:57,430] {warnings.py:99} WARNING - /home/***/.local/lib/python3.6/site-packages/***/utils/context.py:152: AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
  warnings.warn(_create_deprecation_warning(key, self._deprecation_replacements[key]))

[2024-05-06 07:39:57,562] {taskinstance.py:1426} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=ingest_data_bigquery_yt
AIRFLOW_CTX_TASK_ID=download_dataset_task
AIRFLOW_CTX_EXECUTION_DATE=2019-06-02T06:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2019-06-02T06:00:00+00:00
[2024-05-06 07:39:57,563] {subprocess.py:62} INFO - Tmp dir root location: 
 /tmp
[2024-05-06 07:39:57,564] {subprocess.py:74} INFO - Running command: ['bash', '-c', 'curl -sSL https://github.com/DataTalksClub/nyc-tlc-data/releases/download/yellow/yellow_tripdata_2019-06.csv.gz > /opt/***/raw_data/yellowtaxi_tripdata_2019-06.csv.gz && gunzip /opt/***/raw_data/yellowtaxi_tripdata_2019-06.csv.gz']
[2024-05-06 07:39:57,690] {subprocess.py:85} INFO - Output:
[2024-05-06 07:40:36,135] {subprocess.py:93} INFO - Command exited with return code 0
[2024-05-06 07:40:36,329] {taskinstance.py:1277} INFO - Marking task as SUCCESS. dag_id=ingest_data_bigquery_yt, task_id=download_dataset_task, execution_date=20190602T060000, start_date=20240506T073956, end_date=20240506T074036
[2024-05-06 07:40:36,476] {local_task_job.py:154} INFO - Task exited with return code 0
[2024-05-06 07:40:36,698] {local_task_job.py:264} INFO - 1 downstream tasks scheduled from follow-on schedule check
